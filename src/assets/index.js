(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var s;(function(e){e[e.Email=2]="Email",e[e.Phone=3]="Phone"})(s||(s={}));var d;(function(e){e[e.UNSET=0]="UNSET",e[e.MALE=1]="MALE",e[e.FEMALE=2]="FEMALE",e[e.OTHER=3]="OTHER"})(d||(d={}));var m;(function(e){e[e.UNSET=0]="UNSET",e[e.NEW=1]="NEW",e[e.ACTIVE=2]="ACTIVE",e[e.VERIFIED=3]="VERIFIED",e[e.BLOCKED=4]="BLOCKED"})(m||(m={}));var l;(function(e){e[e.Unset=0]="Unset",e[e.EMAIL=1]="EMAIL",e[e.PHONE=2]="PHONE",e[e.MESSENGER=3]="MESSENGER"})(l||(l={}));function f(){let e="";try{e=Intl.DateTimeFormat().resolvedOptions().timeZone}catch{}return e}function p(e){return{customer:{id:"",login_type:e.loginType,login:(e.loginType===s.Email?e.email:e.phone)||"",status:0,settings:{language:e.language,news_enabled:!0,notification_channel:e.loginType===s.Phone?[l.PHONE]:e.loginType===s.Email?[l.EMAIL]:[],timezone:f()},contacts:{phone:e.loginType===s.Phone&&e.phone||"",email:e.loginType===s.Email&&e.email||""},personal_info:{first_name:"",middle_name:"",last_name:"",gender:d.UNSET,personal_id:"",iban:""},operator_id:"",address:{country:"",region:"",city:"",home_address:"",zip_code:""},is_email_confirmed:!1,is_phone_confirmed:!1,level:"",is_profile_filled:!1,registration_site_id:"",operating_region_id:e.region},currency:e.currency,promo_code:e.promoCode||"",password:e.password}}async function h(e,r){return fetch(`${e}/api/v1/site/traffic/mirrors`,{method:"POST",body:JSON.stringify({campaign_id:r})}).then(t=>t.json())}async function g(e,r){return fetch(`${e}/api/v1/site/traffic/mirrors/stats`,{method:"POST",body:JSON.stringify(r)})}async function E(e,r){return fetch(`https://${e}/api/v1/customer/signup`,{method:"POST",body:JSON.stringify(p(r))}).then(t=>t.json())}async function y(e,r){try{const t=await h(e,r),o=await v(t);if(!o)throw new Error("No available mirrors");const n=P(t,o);return await g(e,n).catch().then(()=>{const i=o[0];if(i){const a=w(t.params);return{domain:i,path:t.path,paramsString:a}}throw new Error("No available mirrors")})}catch{throw new Error("No available mirrors")}}async function v(e){if(!e||!e.domains)return null;const r=e.domains.map(t=>_(`https://${t}/x-hash-x.js`).then(o=>o.text()).then(o=>o==="4f0bf1672ff945fb7e8d6003506e0dcb21a43c33"?t:null).catch(()=>null));return Promise.all(r).then(t=>t.filter(o=>!!o)).catch(()=>[])}async function _(e){const t=new AbortController,o=setTimeout(()=>t.abort(),1e4),n=await fetch(e,{method:"GET",signal:t.signal});return clearTimeout(o),n}function P(e,r){const t=e.domains.reduce((o,n)=>(o[n]=r.includes(n),o),{});return{pool_id:e.pool_id,domains:t}}function w(e){const r=[];return Object.entries(e).forEach(([t,o])=>{r.push(`${t}=${o}`)}),r.join("&")}function O({activeDomainData:e,isError:r,refreshToken:t}){const o=S(e,t),n=e.path.replace(/\/$/,""),i=r?"/register":n;return`https://${e.domain}${i}${o}`}function S(e,r){const t=new URL(window.location.href).searchParams,i=[(r?[...Array.from(t.entries()),["refresh_token",r]]:Array.from(t.entries())).filter(([a])=>a!=="rid").map(([a,u])=>`${a}=${u}`).join("&"),e.paramsString].filter(a=>!!a).join("&");return i?`?${i}`:""}const b="https://hrtzbtz.cc",L="686a47af";let c=null;document.addEventListener("DOMContentLoaded",async()=>{try{c=await y(b,L),console.log("Domain data:",c)}catch(t){console.error("Ошибка получения домена:",t)}const e=document.querySelector(".modal");document.querySelectorAll(".modal-open").forEach(t=>{t.addEventListener("click",()=>e.classList.add("active"))}),document.querySelectorAll(".close").forEach(t=>{t.addEventListener("click",()=>e.classList.remove("active"))}),document.getElementById("registerForm").addEventListener("submit",async t=>{if(t.preventDefault(),!c)return alert("Domain data not loaded");const o=document.getElementById("email").value,n=document.getElementById("password").value;try{const i=await E(c.domain,{email:o,phone:null,password:n,currency:"EUR",loginType:s.Email,region:"",language:"en"}),a=O({activeDomainData:c,refreshToken:i.refresh_token});a&&(window.location.href=a)}catch(i){console.error("Ошибка регистрации:",i),alert("Ошибка регистрации, попробуйте еще раз")}})});
